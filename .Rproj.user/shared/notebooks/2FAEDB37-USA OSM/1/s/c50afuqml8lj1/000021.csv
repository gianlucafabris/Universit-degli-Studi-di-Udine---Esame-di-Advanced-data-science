"0","#creazione grafo fully connected per clustering"
"0","edges = expand.grid(county1 = as.character(roads_nodes$county), county2 = as.character(roads_nodes$county), stringsAsFactors = FALSE)"
"0","edges = edges[edges$county1 < edges$county2, ]"
"0","edges = edges %>%"
"0","  left_join(roads_nodes, by = c(""county1"" = ""county"")) %>%"
"0","  rename(y_u = lat, x_u = lon) %>%"
"0","  left_join(roads_nodes, by = c(""county2"" = ""county"")) %>%"
"0","  rename(y_v = lat, x_v = lon) %>%"
"0","  mutate(dist = sqrt((x_v - x_u)^2 + (y_v - y_u)^2)) %>%"
"0","  select(county1, county2, dist)"
"0",""
"0","roads_FC = create_state_graph(roads_nodes, edges)"
"0",""
"0","roads_edges_FC = edges"
"0","rm(edges)"
"0",""
"0","r_co = communities(roads)"
"0","r_cl = clustering(roads_FC)"
"0",""
"0","for(i in 1:nrow(r_co)){"
"0","  print(paste(""Comunità"", r_co$method[[i]], "": modularità"", modularity(r_co$result[[i]]), ""numero comunità"", length(r_co$result[[i]])))"
"0","  print("
"0","    roads %>%"
"0","      ggraph(layout = 'manual', x = x, y = y) +"
"0","        geom_node_point(aes(colour = factor(membership(r_co$result[[i]])))) +"
"0","        geom_edge_link(aes(colour = crossing(r_co$result[[i]], roads))) +"
"0","        scale_x_continuous(guide = ""none"") +"
"0","        scale_y_continuous(guide = ""none"") +"
"0","        coord_fixed(ratio = 1) +"
"0","        scale_color_discrete(guide = ""none"") +"
"0","        scale_edge_color_manual(values = c(""TRUE"" = ""#86F5FA"", ""FALSE"" = ""#000000""), guide = ""none"") +"
"0","        labs(title = paste(""USA - comunità"", r_co$method[[i]]), x = ""X"", y = ""Y"", color = """", edge_color = """") +"
"0","        theme_minimal() +"
"0","        theme(axis.text.x=element_text(color=""#000000""), axis.text.y=element_text(color=""#000000""), axis.line=element_line(color=""#000000""), panel.background=element_rect(fill=""#ffffff""), panel.grid.major.x=element_line(colour=""#ebebeb""), panel.grid.major.y=element_line(colour=""#ebebeb""), plot.title=element_text(size=rel(1.5)))"
"0","  )"
"0","}"
"1","[1]"
"1"," ""Comunità edge_betweenness : modularità 0.920843633522139 numero comunità 158"""
"1","
"
"1","[1]"
"1"," ""Comunità fast_greedy : modularità 0.922059133734641 numero comunità 161"""
"1","
"
"1","[1]"
"1"," ""Comunità label_prop : modularità 0.83963697094957 numero comunità 299"""
"1","
"
"1","[1]"
"1"," ""Comunità leading_eigen : modularità 0.899372221027243 numero comunità 179"""
"1","
"
"1","[1]"
"1"," ""Comunità louvain : modularità 0.924019286941179 numero comunità 163"""
"1","
"
"1","[1]"
"1"," ""Comunità walktrap : modularità 0.902676594334143 numero comunità 205"""
"1","
"
"1","[1]"
"1"," ""Comunità infomap : modularità 0.832371376229918 numero comunità 328"""
"1","
"
