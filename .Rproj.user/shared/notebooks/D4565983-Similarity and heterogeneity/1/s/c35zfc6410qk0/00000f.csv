"0","shannon = function(p) {"
"0","  x = p * log2(p)"
"0","  x = replace(x, is.nan(x), 0)"
"0","  return(-sum(x))"
"0","}"
"0",""
"0","simpson = function(p) {"
"0","  x = 1 - sum(p * p)"
"0","  return(x)"
"0","}"
"0",""
"0","rao = function(p, D) {"
"0","  x = diag(p) %*% D %*% diag(p)"
"0","  return(sum(c(x)))"
"0","}"
"0",""
"0",""
"0","heterogeneity = function(g, D, mode = ""col"") {"
"0","  A = as_adjacency_matrix(g, attr = ""weight"", sparse = FALSE)"
"0","  if (mode == ""col"") {"
"0","    A = A %*% diag(1/colSums(A))"
"0","    dim = 2 "
"0","  } else {"
"0","    A = diag(1/rowSums(A)) %*% A"
"0","    dim = 1 "
"0","  }"
"0","  return(list(shannon = apply(A, dim, shannon), "
"0","              simpson = apply(A, dim, simpson), "
"0","              rao = apply(A, dim, rao, D)))"
"0","}"
"0",""
